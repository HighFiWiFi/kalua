FUNC_WEBLOGIN=1

func_weblogin_output_loginpage ()
{
	func_http_header_mime_output "text/html"
	
	cat <<EOF
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD>
<TITLE>Weblogin</TITLE>
<META HTTP-EQUIV="cache-control" CONTENT="no-cache">
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=ISO-8859-1">
</HEAD>
<BODY BGCOLOR="white"><CENTER>
<A HREF="#" TITLE="diese Seite in deutsch anzeigen"><IMG SRC="images/flag_de.gif" BORDER="0" ALT="de" TITLE="diese Seite in deutsch anzeigen">&nbsp;deutsch</A>
&nbsp;&nbsp;<A HREF="#" TITLE="show this page in english"><IMG SRC="images/flag_en.gif" BORDER="0" ALT="en" TITLE="show this page in english">&nbsp;english</A>
&nbsp;&nbsp;<A HREF="#" TITLE="afficher cette page en anglais"><IMG SRC="images/flag_fr.gif" BORDER="0" ALT="fr" TITLE="afficher cette page en anglais">&nbsp;fran&ccedil;ais</A>
<BR><BR><IMG SRC="images/logo.gif" TITLE="logo" ALT="logo"><FORM METHOD="post" ACTION="">
<TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0">
<TR><TD ALIGN="CENTER"><B><BIG>Internetzugang</BIG></B></TD></TR>
<TR><TD ALIGN="CENTER"><BR><TABLE CELLSPACING="0" CELLPADDING="2" BORDER="0">
<TR><TD ALIGN="RIGHT">Benutzername:&nbsp;<INPUT TYPE="text" SIZE="10" MAXLENGTH="30" NAME="FORM_USER"></TD></TR>
<TR><TD ALIGN="RIGHT">Passwort:&nbsp;<INPUT TYPE="password" SIZE="10" MAXLENGTH="10" NAME="FORM_PASS"></TD></TR></TABLE></TD></TR>
<TR><TD><BR><INPUT TYPE="checkbox" NAME="FORM_RULES">&nbsp;Ich akzeptiere die <A HREF="#RULES" TITLE="ausf&uuml;hrliche Informationen zu den Vertragsbedingungen">Nutzungsbedingungen</A></TD></TR>
<TR><TD ALIGN="CENTER"><BR><INPUT TYPE="image" SRC="images/button_login_de.gif" ALT="Login"></TD></TR>
</TABLE></FORM></CENTER>
</BODY>
EOF
}

func_weblogin_output_login_error ()
{
	func_http_redirect 302 ip_wifi
}

func_weblogin_check_login ()
{
	local USER="$1"
	local PASS="$2"
	local CRC="$( echo -n "${USER}${PASS}" | md5sum | cut -d' ' -f1 )"
	
	local ANSWER="$( wget -qO - "http://10.63.168.65/cgi-bin-sql?LOGIN=$CRC" 2>/dev/null )"		# fixme!
	
	[ "$ANSWER" = "1" ] && return 0
	
	return 1
}
